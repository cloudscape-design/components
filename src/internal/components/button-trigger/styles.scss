/*
 Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 SPDX-License-Identifier: Apache-2.0
*/

@use '../../styles' as styles;
@use '../../styles/tokens' as awsui;
@use '../../hooks/focus-visible' as focus-visible;
@use '../../../token-group/constants' as tokenGroup;

@use './motion';

.button-trigger {
  @include styles.styles-reset;

  position: relative;
  display: flex;
  inline-size: 100%;
  justify-content: space-between;
  align-items: center;
  padding-block: styles.$control-padding-vertical;
  padding-inline: styles.$control-padding-horizontal;

  background-color: awsui.$color-background-input-default;
  border-start-start-radius: styles.$control-border-radius;
  border-start-end-radius: styles.$control-border-radius;
  border-end-start-radius: styles.$control-border-radius;
  border-end-end-radius: styles.$control-border-radius;
  border-block: styles.$control-border-width solid awsui.$color-border-input-default;
  border-inline: styles.$control-border-width solid awsui.$color-border-input-default;
  min-block-size: awsui.$size-vertical-input;

  &.has-caret {
    padding-inline-end: styles.$control-icon-horizontal-padding;
  }

  > .placeholder {
    @include styles.form-placeholder;
  }

  > .arrow {
    position: absolute;
    inset-inline-end: styles.$control-icon-horizontal-offset;
    inset-block-start: styles.$control-icon-vertical-offset;
    color: awsui.$color-text-button-inline-icon-default;
  }

  &:hover {
    > .arrow {
      color: awsui.$color-text-button-inline-icon-hover;
    }
  }

  &.pressed {
    > .arrow {
      transform: rotate(-180deg);
    }
  }

  &.disabled {
    @include styles.form-disabled-element;
    > .arrow {
      color: awsui.$color-text-button-inline-icon-disabled;
    }
    &.in-filtering-token {
      border-color: awsui.$color-border-control-disabled;
    }
    > .placeholder {
      @include styles.form-placeholder-disabled;
    }
  }

  &.read-only {
    @include styles.form-readonly-element;
  }

  &:focus {
    outline: none;
    text-decoration: none;
  }

  &:not(.in-filtering-token) {
    @include focus-visible.when-visible {
      @include styles.form-focus-element();
    }
    &:invalid {
      // discard built-in invalid styles, customers should use `invalid` property only (AWSUI-3947)
      box-shadow: none;
    }

    &.invalid,
    &.invalid:focus {
      @include styles.form-invalid-control();
    }

    &.warning,
    &.warning:focus {
      @include styles.form-warning-control();
    }
  }

  &.in-filtering-token {
    border-color: tokenGroup.$token-border-color;
    border-start-end-radius: 0;
    border-end-end-radius: 0;
    block-size: 100%;
    @include focus-visible.when-visible {
      @include styles.focus-highlight(awsui.$space-filtering-token-operation-select-focus-outline-gutter);
    }
  }

  &.inline-tokens {
    // Remove default paddings and just rely on center alignment of the content
    padding-block: 0;
  }
}

.inlineLabelWrapper {
  display: block;
  margin-top: calc(awsui.$space-scaled-xs * -1);
}

.inlineLabel {
  box-sizing: border-box;
  display: inline-block;
  color: awsui.$color-text-form-label;
  font-weight: awsui.$font-display-label-weight;
  font-size: 12px;
  line-height: 14px;
  position: relative;
  left: 10px;
  padding-block: awsui.$space-scaled-xs awsui.$space-scaled-xxs 0;
  max-inline-size: calc(100% - 22px);
  // Stepped gradient background for label overlap between input and background.
  background-image: linear-gradient(
    to bottom,
    transparent calc(100% - (awsui.$space-scaled-xs + 1px)),
    awsui.$color-background-input-default 1px
  );
  background-position: bottom;
  z-index: 1;
}

.buttonTrigger-inlineLabel {
  margin-block-start: -7px;
}
